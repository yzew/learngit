CVPR 2019：Does Learning Specific Features for Related Parts Help Human Pose Estimation?

# Abstract

​		人体姿态估计(HPE)本质上是一个homogeneous(同质的同类的均质单一性的均匀的)的多任务学习问题，每个身体部位的定位是一个不同的任务。最近的HPE方法**普遍学习所有部件的共享表示**，从这些部件的位置进行线性回归。然而，我们的统计分析表明，并非所有的部分都是相互关联的。因此，这种共享机制可能**会导致负迁移（negative transfer）和性能恶化**。这个潜在的问题促使我们提出一个有趣的问题。我们能否识别相关的部件，并了解它们的具体特征，以改进姿态估计?由于不相关的任务不再共享一个high-level representation，我们希望避免负迁移的不利影响。此外，模型中还**加入了更明确的结构知识**，如脚踝和膝盖是高度相关的，这有助于解决HPE中的歧义/模糊（ambiguities）。为了回答这个问题，我们首先提出了一种数据驱动的方法，根据共享的信息对相关部分进行分组。然后引入基于部件的分支网络(PBN)来学习特定于每个部件组的表示。我们进一步提出了该网络的多阶段版本，以重复细化中间特征和提出估计。消融实验表明，特定特征的学习能显著改善遮挡的（occluded）部位的定位，从而有利于HPE。在两个基准数据集上，我们的方法也优于所有最先进的方法，在发生遮挡时具有突出的优势。



大白话：
目前几乎所有的pose 网络,针对“单人姿态估计网络”，几乎都是共享全部feature 的。这个的意思从代码上来理解就是，在最后一层 1*1的那个卷积层 一次性输出所有需要预测的 joint，他们的输入都是相同的。

这篇文章的作者，这里这样做是不合理的，并不是所有的关键点都是需要共享 high-level representation的，这样做反而会降低预测结果！



# **1. Introduction**

​		早期的工作试图通过手工制作的特征和图形模型来解决这个问题。然而，在严重的身体变形、遮挡、杂乱的背景和不同的视点的情况下，他们未能表现良好。

​		描述了下一般的方法.......

​		这些方法的一个共同点是，它们学习一个共享的表示来线性回归所有部件的位置(以空间坐标或热图的形式)，如图1的上部所示。这比学习针对不同部分的不同网络更有效，因为HPE本质上是一个同构多任务学习(MTL)问题[33]，将每个部分定位为不同的任务。在相关任务之间共享表示可以使模型更紧凑，泛化能力更好[4,33]。具体来说，cnn的前几层学习诸如Gabor滤波器和色斑等底层特征，这些特征对许多数据集和任务[54]都是通用的。更高级的语义，例如身体部位，出现在更深的层次[56,54]。某些部位(如膝盖)的提示为其他相关部位(如脚踝)的定位提供了重要信息和约束，如果表示不共享，则很难学习这些部位[4,33]。

***

![image-20221101164236891](E:\MarkDown\picture\image-20221101164236891.png)

上图:之前的方法利用cnn来学习所有身体部位的完全共享特征，从这些部位的位置，以空间坐标或热图的形式，进行线性回归。

中:各部位位置与右脚踝位置的相互信息

底部:我们的统计分析(第3.1节)表明并非所有部分都彼此相关。基于对不相关任务共享表示可能会降低其性能的事实，本文试图识别相关部分，并研究学习特定特征是否有助于提高姿态估计。

***

​		然而，由于关节人体的灵活性，并不是所有的部件都彼此相关。例如，左手腕或右手腕的提示几乎不能提供关于右脚踝位置的信息，如图1中间部分所示。正如MTL文献[4,33,19,17]所研究的那样，为那些不相关或弱相关的任务共享特征会降低它们的表现——这种现象被称为负转移[44]。虽然相关部分的提示为定位模棱两可或遮挡的部分提供了可靠的指导，但从不相关的特征回归使模型强制记忆它们，导致过拟合[8]。这种分析促使我们提出一个有趣的问题。我们能否识别相关的部件，并了解它们的具体特征，以改进姿态估计?图1的下半部分说明了这一思想。在卷积网络的较浅层中学习到的表示是通用的[54,56]，因此可以在所有部分之间安全地共享。由于不相关的任务不再共享高级特性，我们期望避免负迁移的不利影响。此外，显示了更明确的结构知识，如脚踝和膝盖是高度相关的，这鼓励模型利用相关部分的提示来解决HPE中的模糊性/歧义。

​		本文的目的就是对这一问题进行全面的研究。我们从两种策略识别相关的部分。第一个是手工制作的，基于人体结构[41,38,59]。直觉上，相连接的部分自然是相互关联的。第二种策略是数据驱动，将每个部件的位置视为随机变量。我们从公共数据集[1]估计它们的概率分布，并根据它们的相互信息对相关部分进行分组。然后介绍了一种基于部件的分支网络(PBN)。它包括一个主干来学习通用于所有身体部位的共享表示，以及一些后续分支来学习特定于每组相关部位的高级特征。最后，我们提出了该网络的多阶段版本，以重复细化中间特征和姿态估计。

​		我们的消融研究表明(1)数据驱动的部件分组策略通常比手工制作的更好，(2)学习这些特定的特征显著提高遮挡部件的定位，从而有利于HPE。在两个基准上的实验结果表明，所提出的方法优于所有最先进的方法，当遮挡发生时具有明显的优势。

​		总之，本文的贡献如下：

* 以前所有基于cnn的HPE方法都想当然地认为，所有身体部位的特征都应该完全共享。据我们所知，我们是第一个发现这种做法的问题并通过一个简单有效的基于部件的分支网络来解决它的人。
* 这是第一次尝试利用部件位置的概率分布及其相互信息来对相关零件进行分组。我们证明了它比基于人体结构的替代方法更有效。
* 我们的模型在定位遮挡部位上具有突出的优势，这是现有方法面临的最大挑战。我们还报告了两个著名基准数据集的最新结果。



# 2. Related Work

MTL。通过使用共享表示并行的学习任务，MTL[4,58,13,26]利用相关任务训练信号中包含的域信息作为归纳偏置来提高泛化能力。它期望从每项任务中学到的东西能帮助更好地学习其他任务。

相关的部分。一些研究已经利用相关部分构建了层次图形模型[10,16,299,30,41,47]或HPE的网络架构[38]。我们的方法与他们的不同之处在于:(1)他们为所有身体部位使用完全共享(手工制作或学习)的特征，而我们学习相关部位的特定特征;(2)他们根据主体结构手动定义相关部件，我们也考虑基于相互信息的数据驱动方法。



# 3. Our Approach

​		我们首先介绍两种识别相关身体部位的策略(第3.1节)。然后，提出了一个基于部件的分支网络来学习它们的特定特征(第3.2节)。最后，我们提出了该网络的多阶段版本，以反复细化中间特征和部件位置(第3.3节)。

## 3.1. Related body parts

​		识别相关部位最直接的方法是利用人体结构。直觉上，相连接的部件自然是相互关联的。身体部位可分为六组:(1)头顶、上颈和胸部，(2)左腕、左肘和左肩，(3)右腕、右肘和右肩，(4)左膝和左脚踝，(5)右膝和右脚踝，(6)左髋、右髋和骨盆。

![image-20221101182943301](E:\MarkDown\picture\image-20221101182943301.png)

 (a)每一对身体部位之间的标准化相互信息。(b) 对(a)矩阵进行谱聚类得到的五组相关部件。

> 互信息(Mutual Information)是[信息论](https://baike.baidu.com/item/信息论/302185?fromModule=lemma_inlink)里一种有用的信息度量，它可以看成是一个[随机变量](https://baike.baidu.com/item/随机变量/828980?fromModule=lemma_inlink)中包含的关于另一个随机变量的信息量，或者说是一个随机变量由于已知另一个随机变量而减少的不肯定性
>
> 直方图估计:pi=ni/N▲i，即将16*16的格子展开，统计某个关键点在数据集所有图片中出现的位置。p(lm, ln)就是统计两个点同时出现的直方图

​		第二种策略是从公共数据集估计它们的概率分布，通过互信息对相关部分进行分组。将各部分的位置视为随机变量lm∈L, m∈{1，…， M}，其中L为空间域，M为感兴趣的身体部位总数。衡量两个随机变量之间的相关性或相互依赖性的合理方法是计算它们的互信息[25]:

![image-20221101184122234](E:\MarkDown\picture\image-20221101184122234.png)

其中p(·)和p(·，·)分别表示边缘概率分布和联合概率分布。它量化了 通过观察另一个随机变量中包含的的关于一个随机变量的信息量。I(lm, ln)的值越大，说明与第m部分相关性强的特征也提供了第n部分的信息线索，反之亦然。因此，为它们共享高级代表应该是有益的。与衡量两个随机变量之间线性关联强度的Pearson correlation皮尔逊相关相比，相互信息在这里是一个更合适的度量，因为它既考虑线性关联也考虑非线性关联，当且仅当两个随机变量独立时，互信息为零。

​		我们以非参数的方式从数据中估计部件位置的分布。这里采用MPII人体姿势数据集[1]，因为：(1)它有25k训练样本，具有高质量的注释，例如人体姿势、尺度和中心；(2)它涵盖了广泛的日常人类活动和各种各样的全身姿势。我们缩放姿态，并在一个归一化的空间域中居中，即16 × 16的格子。低分辨率是必要的，因为：(1)使统计估计对小姿态扰动具有鲁棒性 (2)样本总数有限。然后用直方图估计p(lm, ln)，其中m, n∈{1，…, M}。

​		图2(a)显示了计算出的每一对身体部位之间的互信息。为了关注不同部分之间的相关性，我们去掉了对角线元素，并将所有剩余条目线性归一化，使其在[0,1]之内。显然，有些部位，如右脚踝和左脚踝，比其他部位(如右脚踝和左手腕)更相关。

​		最后，我们将{ I(lm, ln) }m,n∈{1，…，M}作为关联矩阵，并使用谱聚类[9]对相关部分进行分组。例如，将集群数量设置为5将产生如图2(b)所示的部件分组。我们可以看到同一组的大部分部件在身体骨架上是相连的，这与我们的直觉一致。唯一的例外是用紫色点表示的一组脚踝ankle和膝盖knee。从图2(a)中我们很容易理解这个结果:它们之间的互信息量都很高。即使集群数量增加一个，这四个部分仍然在同一个组中。相反，头部和颈部将与肩膀和胸部分离。

## 3.2. Part-based branching network (PBN)

![image-20221101191741487](E:\MarkDown\picture\image-20221101191741487.png)

图3。用于HPE的基于部件的分支网络(PBN)的说明。灰色和蓝色矩形分别表示输入图像和预测热图。黄色和绿色矩形分别代表共享和特定的特征。通道数量包含在每个彩色矩形中。应用MSE损失将预测的热图与地面真实热图进行比较。



​		如图3所示，基于部位的分支网络(PBN)是一种CNN架构，由两个顺序的阶段组成:一个主干学习通用于所有身体部位的共享表示，另一个分支学习特定于每组相关部位的高级特征。根据单人姿势估计的标准协议[6,18,28,38,50]，它的输入是一个围绕目标人物裁剪的RGB图像，并缩放到固定的大小，例如256 × 256。

​		该网络首先使用卷积和最大池化来生成空间维度减小但通道数量增加的特征图，这是最近CNN体系结构采用的做法[14,28,38,50]。具体来说，它从三个3 × 3卷积层(64个通道)和一个2 × 2池化层(在第一次卷积之后)开始，接着是一个残差结构(128个通道)和另一轮池化，将分辨率从256 × 256降低到64×64。经过后续两个残差模块(128和256通道)，得到分辨率为64 × 64的256通道特征图，即图3中第一个黄色矩形。

​		其次是沙漏网络HG[28]，增强共享表示。它使用残差块和maxpoolings处理输入特征到非常低的分辨率，即4 × 4。在每个最大池化步骤中，网络分支并在原始预池化分辨率处应用另一个残差块。当达到最低分辨率时，它开始自上而下的顺序进行上采样和元素积相加，以组合跨尺度的特征。在输出分辨率的后续残差块之后，网络输出与其输入大小相同的特征映射。这里所有的残块输出256通道的特征。

​		这里采用沙漏网络有两个原因。首先，通过跨多个尺度处理和整合特征，它可以捕获输入特征映射中的各种空间关系和上下文。其次，八层沙漏网络及其最新变体[6,50,18,38]在标准基准测试中取得了最先进的结果。因此，它可以作为一个合适的基线来测试学习相关部件的特定特征是否有助于提高位姿估计

​		最后，网络使用一组分支来学习相关部件的特定特征，如图3所示。对于每个部件组，我们首先应用1 × 1卷积将特征维数从256降至W，例如W = 64。在D个后续残块后，例如D = 1，再进行1 × 1卷积，回归该组各部分的热图。热图的每个像素代表零件在相应坐标上出现的概率。这里W和D是两个超参数，分别控制特定特征层的宽度和深度[14]。我们将通过烧蚀实验来研究它们对HPE性能的影响。在训练阶段，应用均方误差(MSE)损失来比较预测的热图与以零件位置为中心的二维高斯(std=1像素)组成的地面真实热图。

​		由于不相关的任务不再使用完全共享表示学习，PBN可以减少负迁移的不利影响。与对不同部分使用不同分支或对所有部分使用一个分支相比，我们的方法包含了更明确的结构知识。例如，将高度相关的脚踝和膝盖引入到网络中，并引导网络利用相关部位的提示来解决姿态估计中的歧义/模糊性。

## 3.3. Stacked PBNs

![image-20221101194137840](E:\MarkDown\picture\image-20221101194137840.png)

图四。多个pbn堆叠示意图。图3中的符号在这里重复使用。每个PBN预测一组热图，即蓝色矩形。使用相同的gt(图中省略)对它们应用MSE损失。橙色和绿色虚线表示将共享或特定特性传播到下一个PBN的两个选项。在实践中，我们发现前者效果更好。

​		最近的研究[28,50,6,38]表明，将多个CNN模块端到端依次堆叠，将其中一个模块的输出作为下一个模块的输入，可以在整个图像中反复细化初始估计和中间特征。这促使我们将我们的网络扩展到一个多阶段版本，如图4所示。继Newell et al[28]之后，通过elementwise加法融合了三个特征映射:(1)来自当前沙漏输入的恒等映射;(2)通过1 × 1卷积重新映射的热图预测，以匹配中间特征的通道数;(3)沙漏之后的共享特征，如图4中橙色虚线所示。然后，融合结果直接作为下一个PBN的输入，生成另一组预测。使用相同的gt对所有堆叠的pbn的预测应用了MSE损失。

​		我们还考虑了传播特定的特征，而不是将共享的特征传播到后续的PBN，如图4中的绿色虚线所示。然而，我们在实践中发现，这将给学习过程带来困难，增加训练和验证损失，降低HPE性能。



# 4. Experiments

​		我们的方法在两个HPE基准数据集上进行评估:MPII人体姿势[1]和Leeds Sports Pose(LSP)[16]。MPII数据集包含约25k图像和40k注释样本(28k用于训练，11k用于测试)。根据[43,28,38]，取3k个样本作为验证集来优化超参数并进行消融研究。LSP数据集及其扩展训练集包含11k张训练图像和1k张测试图像，来自运动活动。作为一种常见的做法[48,6,38]，我们通过包含MPII训练样本来训练网络。

​		**根据之前的工作，我们使用正确关键点百分比(PCK)[1]作为评估指标。对于LSP，距离是由躯干大小归一化的，而对于MPII，是由头部大小的一部分归一化的(称为PCKh)。**

## 4.1. Implementation details

每个输入图像都是根据标注的身体位置和比例裁剪目标人物周围的图像。然后它们被调整为256 × 256像素，然后再被输入网络。训练数据通过随机缩放(+/- 0.25)、旋转(+/- 30度)、剪切(+/- 0.5)、水平翻转和颜色抖动增强。我们的实现基于Torch[7]。我们通过RMSProp[42]优化网络，批量大小为16，用于250个epoch。学习率初始为2.5 × 10−4，在第170和220期下降了10倍。最后的预测是由最后的PBN估计的每个热图的最大激活位置。

## 4.2. Benchmark results





















